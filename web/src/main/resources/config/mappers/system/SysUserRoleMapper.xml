<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.company.modules.system.dao.SysUserRoleDao">
	<resultMap id="sysUserRoleResult" type="sysUserRole">
		<result column="id" property="id" />
		<result column="role_id" property="roleId" />
		<result column="user_id" property="userId" />
	</resultMap>
	
	<insert id="insert" parameterType="sysUserRole">
		<selectKey resultType="long" keyProperty="id">
			SELECT LAST_INSERT_ID() AS ID
		</selectKey>
		insert into sys_user_role(
			role_id,
			user_id				
		)
		values (
			#{roleId},
			#{userId}				
		)
	</insert>
	
	<delete id="deleteByUserId" parameterType="long">
		delete from sys_user_role
		where
		user_id  = #{userId}
 	</delete> 
	
    <select id="getItemListByMap"	parameterType="java.util.HashMap" resultMap="sysUserRoleResult">
		select * 
		from  sys_user_role
		where 1=1
		<if test="roleId != null">
		    AND role_id = #{roleId}
        </if>
        <if test="userId != null">
            AND user_id = #{userId}
        </if>
        <if test="id != null">
            AND id = #{id}
        </if>
	</select>
	
	<select id="getSysUserRoleByNid"	parameterType="java.util.HashMap" resultMap="sysUserRoleResult">
		SELECT
			*
		FROM
			sys_user_role su
		INNER JOIN sys_user u ON u.id = su.user_id
		INNER JOIN sys_role r ON r.id = su.role_id
		WHERE
			u.is_delete = 0
		AND r.is_delete = 0
		<if test="userId != null">
		    AND u.id = #{userId}
        </if>
        <if test="nid != null">
            AND r.nid = #{nid}
        </if>
	</select>


	<!-- <update id="update" parameterClass="sysUserRole">
		update sys_user_role
		set
			role_id=#roleId#,
			user_id=#userId#				
		where
			id = #id#
	</update> -->
   
 	<!-- <select id="getItemById" parameterClass="long" resultMap="sysUserRoleResult">
		select
			id,
			role_id,
			user_id				
		from sys_user_role
		where 
			id = #id#
	</select> -->
	
	<!-- <select id="getItemListByIds" parameterClass="java.util.Map" resultMap="sysUserRoleResult">
		select
			id,
			role_id,
			user_id				
		from sys_user_role
		where
		<iterate open="(" close=")" conjunction="," property="ids">
			#id[]#
		</iterate>
	</select> -->
	
 	<!-- <delete id="deleteByIds" parameterClass="java.util.Map">
		delete from sys_user_role
		where
		<iterate open="(" close=")" conjunction="," property="ids">
			#id[]#
		</iterate>
 	</delete> -->
 	
 	<!-- <delete id="deleteByUserId" parameterClass="long">
 	  delete from sys_user_role
 	  where
 	  user_id = #userId#
 	</delete> -->
 	
	<!-- <select id="getPageList" resultMap="sysUserRoleResult" parameterClass="map" >
		select 
			id,
			role_id,
			user_id		
	    from sys_user_role
	    <dynamic prepend="where">
	    	<isNotEmpty prepend="and" property="id">
			      id = #id#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="roleId">
			      role_id = #roleId#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="userId">
			      user_id = #userId#
			</isNotEmpty>
		</dynamic>
			order by id desc
		 	limit #startRow#, #pageSize#
	</select> -->
  
	<!-- <select id="getPageCount" resultClass="int" parameterClass="sysUserRole" >
		select 
			count(*)		
	    from sys_user_role
	    <dynamic prepend="where">
    	<isNotEmpty prepend="and" property="id">
		      id = #id#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="roleId">
		      role_id = #roleId#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="userId">
		      user_id = #userId#
		</isNotEmpty>
		</dynamic>
	</select>    -->
	
	<!-- <select id="getItemInfoByMap" parameterClass="java.util.Map" resultMap="sysUserRoleResult">
	   select 
            id,
            role_id,
            user_id     
        from sys_user_role
        <dynamic prepend="where">
            <isNotEmpty prepend="and" property="id">
                  id = #id#
            </isNotEmpty>
            <isNotEmpty prepend="and" property="roleId">
                  role_id = #roleId#
            </isNotEmpty>
            <isNotEmpty prepend="and" property="userId">
                  user_id = #userId#
            </isNotEmpty>
        </dynamic>
	</select> -->
</mapper>